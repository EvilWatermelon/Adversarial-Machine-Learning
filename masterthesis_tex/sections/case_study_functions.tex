% !TEX root = C:\Users\Jan\Documents\dev\Risk-Measurement-Framework\masterthesis_tex\masterthesis_main.tex
\section{Case Study functions}
\label{sec:case_study_functions}

\textbf{class\_num}
This argument gets the key value from the labels which is an integer. \\ \\
\textbf{train\_number}
This argument gets the number of images from a labeled folder. \\ \\
\textbf{train\_path}
This argument gets the path where the local training data is stored. \\ \\
\textbf{data\_dir}
This argument gets the path where all local images are stored. \\ \\
\textbf{image\_data}
This argument gets an array with all images from a label. \\ \\
\textbf{image\_labels}
This argument gets the label which belongs to the corresponding images. \\ \\
\textbf{X\_train}
This argument gets the training data. \\

\begin{lstlisting}
  dataset_visualization(class_num, train_number)
\end{lstlisting}

\noindent With this function, the number of images are visualized and sorted from the lowest to the highest number of images per label.

\begin{lstlisting}
  read_training_data(train_path, data_dir)
\end{lstlisting}

\noindent This function reads in the training data, calls the \textit{dataset\_visualization()} function and resize the images to $30x30$ pixels. The function is called by the \textit{preprocessing()} function.

\begin{lstlisting}
  preprocessing(train_path, data_dir, image_data, image_labels)
\end{lstlisting}

\noindent After calling the \textit{read\_training\_data()} function, this function assign the \textbf{image\_date} and \textbf{image\_labels} arguments to shuffle the training data. Then the training data splits into training and validation data. The shape of the images must be reshaped for the SVM.

\begin{lstlisting}
  model_training(train_path, data_dir, image_data, image_labels)
\end{lstlisting}

\noindent After calling the \textit{preprocessing()} function, this function calls the \textit{KerasClassifier()} class which is an ART class to use Keras. This class must be used because the attacks only takes these classes for the proxy model training.

\begin{lstlisting}
  read_test_data(train_path, data_dir, image_data, image_labels)
\end{lstlisting}

\noindent After calling the \textit{model\_training()} function, this function reads in the test data, resizes the images to $30x30$ pixels and then reshape the images. The last step is the prediction with the test data.

\begin{lstlisting}
  create_model(X_train)
\end{lstlisting}

\noindent This function builds the ML model architecture for the classifier class of the ART.
